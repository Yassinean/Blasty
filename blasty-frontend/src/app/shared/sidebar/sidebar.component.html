<div
  class="sidebar-container transition-all duration-300 ease-in-out"
  [class.w-64]="!isSidebarCollapsed"
  [class.w-16]="isSidebarCollapsed"
  [class.hidden]="(isHandset$ | async) && !isMobileOpen"
  [class.absolute]="isHandset$ | async"
  [class.z-40]="isHandset$ | async"
  [class.h-full]="isHandset$ | async"
>
  <!-- Sidebar -->
  <aside class="flex flex-col h-full bg-white dark:bg-gray-800 shadow-lg">
    <!-- Logo -->
    <div
      class="flex items-center justify-between p-4 border-b dark:border-gray-700"
    >
      <a routerLink="/admin/dashboard" class="flex items-center">
        <img
          class="h-8 w-auto"
          src="./assets/blasty.png"
          alt="Blasty logo"
          onerror="this.src='https://via.placeholder.com/32x32?text=P'; this.onerror=null;"
        />
        <span
          *ngIf="!isSidebarCollapsed"
          class="ml-2 text-xl font-semibold text-gray-800 dark:text-white"
          >Blasty</span
        >
      </a>
      <button
        (click)="toggleSidebar()"
        class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none"
        [class.hidden]="isHandset$ | async"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 text-gray-500 dark:text-gray-400"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path *ngIf="isSidebarCollapsed" d="M13 5l7 7-7 7M5 5l7 7-7 7" />
          <path *ngIf="!isSidebarCollapsed" d="M11 5l-7 7 7 7M19 5l-7 7 7 7" />
        </svg>
      </button>
      <button
        *ngIf="isHandset$ | async"
        (click)="closeMobileSidebar()"
        class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 text-gray-500 dark:text-gray-400"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 overflow-y-auto py-4">
      <ul class="space-y-2 px-3">
        <!-- Dashboard -->
        <li>
          <a
            routerLink="/admin/dashboard"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            [routerLinkActiveOptions]="{ exact: true }"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="3" width="7" height="9" />
              <rect x="14" y="3" width="7" height="5" />
              <rect x="14" y="12" width="7" height="9" />
              <rect x="3" y="16" width="7" height="5" />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3">Dashboard</span>
          </a>
        </li>

        <!-- Statistics -->
        <li *ngIf="user.role == 'ADMIN'">
          <a
            routerLink="/admin/dashboard/statistics"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M3 3v18h18" />
              <path d="M18 9l-5 5-4-4-5 5" />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3">Statistiques</span>
          </a>
        </li>

        <!-- Parking Management -->
        <li *ngIf="user.role == 'ADMIN'">
          <a
            routerLink="/admin/dashboard/parkings"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M5 4h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"
              />
              <path d="M12 4v16" />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3"
              >Gestion des Parkings</span
            >
          </a>
        </li>

        <!-- Settings -->
        <li>
          <a
            routerLink="/admin/dashboard/settings"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="3" />
              <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
              />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3">Param√®tres</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- User Profile -->
    <div class="p-4 border-t dark:border-gray-700">
      <div class="flex items-center">
        <div
          class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white"
        >
          <span>A</span>
        </div>
        <div *ngIf="!isSidebarCollapsed" class="ml-3">
          <p class="text-sm font-medium text-gray-700 dark:text-gray-200">
            {{ user?.name }}
          </p>
          <p class="text-xs text-gray-500 dark:text-gray-400">{{user?.email}}</p>
        </div>
      </div>
    </div>
  </aside>
</div>

<!-- Overlay for mobile -->
<div
  *ngIf="(isHandset$ | async) && isMobileOpen"
  class="fixed inset-0 bg-black bg-opacity-50 z-30"
  (click)="closeMobileSidebar()"
></div>
