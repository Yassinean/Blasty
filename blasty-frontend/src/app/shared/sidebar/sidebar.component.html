<div
  class="sidebar-container transition-all duration-300 ease-in-out"
  [class.w-64]="!isSidebarCollapsed"
  [class.w-16]="isSidebarCollapsed"
  [class.hidden]="(isHandset$ | async) && !isMobileOpen"
  [class.absolute]="isHandset$ | async"
  [class.z-40]="isHandset$ | async"
  [class.h-full]="isHandset$ | async"
>
  <!-- Sidebar -->
  <aside class="flex flex-col h-full bg-white dark:bg-gray-800 shadow-lg">
    <!-- Logo -->
    <div
      class="flex items-center justify-between p-4 border-b dark:border-gray-700"
    >
      <a
        *ngIf="isAdmin"
        routerLink="/admin/dashboard"
        class="flex items-center"
      >
        <img
          class="h-8 w-auto"
          src="./assets/blasty.png"
          alt="Blasty logo"
          onerror="this.src='https://via.placeholder.com/32x32?text=P'; this.onerror=null;"
        />
        <span
          *ngIf="!isSidebarCollapsed"
          class="ml-2 text-xl font-semibold text-gray-800 dark:text-white"
          >Blasty</span
        >
      </a>
      <a *ngIf="isClient" routerLink="/" class="flex items-center">
        <img
          class="h-8 w-auto"
          src="./assets/blasty.png"
          alt="Blasty logo"
          onerror="this.src='https://via.placeholder.com/32x32?text=P'; this.onerror=null;"
        />
        <span
          *ngIf="!isSidebarCollapsed"
          class="ml-2 text-xl font-semibold text-gray-800 dark:text-white"
          >Blasty</span
        >
      </a>
      <button
        (click)="toggleSidebar()"
        class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none"
        [class.hidden]="isHandset$ | async"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 text-gray-500 dark:text-gray-400"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path *ngIf="isSidebarCollapsed" d="M13 5l7 7-7 7M5 5l7 7-7 7" />
          <path *ngIf="!isSidebarCollapsed" d="M11 5l-7 7 7 7M19 5l-7 7 7 7" />
        </svg>
      </button>
      <button
        *ngIf="isHandset$ | async"
        (click)="closeMobileSidebar()"
        class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 text-gray-500 dark:text-gray-400"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 overflow-y-auto py-4">
      <ul class="space-y-2 px-3">
        <li *ngIf="isClient">
          <a
            routerLink="/client/dashboard"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            [routerLinkActiveOptions]="{ exact: true }"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="3" width="7" height="9" />
              <rect x="14" y="3" width="7" height="5" />
              <rect x="14" y="12" width="7" height="9" />
              <rect x="3" y="16" width="7" height="5" />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3"
              >List des parking</span
            >
          </a>
        </li>

        <li *ngIf="isClient">
          <a
            routerLink="/client/dashboard/reservations"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              version="1.1"
              width="24"
              height="24"
              viewBox="0 0 256 256"
              xml:space="preserve"
            >
              <defs></defs>
              <g
                style="
                  stroke: none;
                  stroke-width: 0;
                  stroke-dasharray: none;
                  stroke-linecap: butt;
                  stroke-linejoin: miter;
                  stroke-miterlimit: 10;
                  fill: none;
                  fill-rule: nonzero;
                  opacity: 1;
                "
                transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"
              >
                <path
                  d="M 64.095 15.942 H 48.905 c -0.553 0 -1 -0.448 -1 -1 s 0.447 -1 1 -1 h 15.189 c 0.553 0 1 0.448 1 1 S 64.647 15.942 64.095 15.942 z"
                  fill="currentColor"
                />
                <path
                  d="M 41.095 15.942 H 25.905 c -0.552 0 -1 -0.448 -1 -1 s 0.448 -1 1 -1 h 15.189 c 0.552 0 1 0.448 1 1 S 41.647 15.942 41.095 15.942 z"
                  fill="currentColor"
                />
                <path
                  d="M 84.137 83.859 H 5.863 C 2.63 83.859 0 81.229 0 77.996 V 19.805 c 0 -3.233 2.63 -5.863 5.863 -5.863 h 12.231 c 0.552 0 1 0.448 1 1 s -0.448 1 -1 1 H 5.863 C 3.733 15.942 2 17.675 2 19.805 v 58.191 c 0 2.13 1.733 3.863 3.863 3.863 h 78.273 c 2.13 0 3.863 -1.733 3.863 -3.863 V 19.805 c 0 -2.13 -1.733 -3.863 -3.863 -3.863 H 71.905 c -0.553 0 -1 -0.448 -1 -1 s 0.447 -1 1 -1 h 12.231 c 3.233 0 5.863 2.63 5.863 5.863 v 58.191 C 90 81.229 87.37 83.859 84.137 83.859 z"
                  fill="currentColor"
                />
                <path
                  d="M 22.293 51.252 h -8.587 c -1.442 0 -2.615 -1.173 -2.615 -2.615 V 40.05 c 0 -1.442 1.173 -2.616 2.615 -2.616 h 8.587 c 1.442 0 2.615 1.173 2.615 2.616 v 8.587 C 24.909 50.079 23.735 51.252 22.293 51.252 z"
                  fill="currentColor"
                />
                <path
                  d="M 49.293 51.252 h -8.586 c -1.442 0 -2.615 -1.173 -2.615 -2.615 V 40.05 c 0 -1.442 1.173 -2.616 2.615 -2.616 h 8.586 c 1.442 0 2.616 1.173 2.616 2.616 v 8.587 C 51.909 50.079 50.735 51.252 49.293 51.252 z"
                  fill="currentColor"
                />
                <path
                  d="M 76.293 51.252 h -8.586 c -1.442 0 -2.616 -1.173 -2.616 -2.615 V 40.05 c 0 -1.442 1.174 -2.616 2.616 -2.616 h 8.586 c 1.442 0 2.616 1.173 2.616 2.616 v 8.587 C 78.909 50.079 77.735 51.252 76.293 51.252 z"
                  fill="currentColor"
                />
                <path
                  d="M 89 30.111 H 1 c -0.552 0 -1 -0.448 -1 -1 s 0.448 -1 1 -1 h 88 c 0.553 0 1 0.448 1 1 S 89.553 30.111 89 30.111 z"
                  fill="currentColor"
                />
                <path
                  d="M 44.34 74.252 c -0.264 0 -0.519 -0.104 -0.707 -0.293 l -4.246 -4.246 c -0.391 -0.391 -0.391 -1.023 0 -1.414 s 1.023 -0.391 1.414 0 l 3.4 3.4 l 5.226 -7.51 c 0.314 -0.454 0.939 -0.566 1.393 -0.25 c 0.453 0.315 0.565 0.939 0.25 1.393 l -5.909 8.491 c -0.169 0.243 -0.438 0.398 -0.732 0.425 C 44.399 74.251 44.37 74.252 44.34 74.252 z"
                  fill="currentColor"
                />
                <path
                  d="M 47.045 23.743 h -4.09 c -1.577 0 -2.86 -1.283 -2.86 -2.86 V 9.001 c 0 -1.577 1.283 -2.86 2.86 -2.86 h 4.09 c 1.577 0 2.86 1.283 2.86 2.86 v 11.882 C 49.905 22.46 48.622 23.743 47.045 23.743 z"
                  fill="currentColor"
                />
                <path
                  d="M 70.045 23.743 h -4.09 c -1.577 0 -2.86 -1.283 -2.86 -2.86 V 9.001 c 0 -1.577 1.283 -2.86 2.86 -2.86 h 4.09 c 1.577 0 2.86 1.283 2.86 2.86 v 11.882 C 72.905 22.46 71.622 23.743 70.045 23.743 z"
                  fill="currentColor"
                />
                <path
                  d="M 24.045 23.743 h -4.09 c -1.577 0 -2.86 -1.283 -2.86 -2.86 V 9.001 c 0 -1.577 1.283 -2.86 2.86 -2.86 h 4.09 c 1.577 0 2.86 1.283 2.86 2.86 v 11.882 C 26.905 22.46 25.622 23.743 24.045 23.743 z"
                  fill="currentColor"
                />
              </g>
            </svg>

            <span *ngIf="!isSidebarCollapsed" class="ml-3">My reservation</span>
          </a>
        </li>
        <li *ngIf="isClient">
          <a
            routerLink="/client/dashboard/tickets"
            routerLinkActive="bg-gray-200 dark:bg-gray-700"
            class="flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5 mr-2"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M15 5v2" />
              <path d="M15 11v2" />
              <path d="M15 17v2" />
              <path
                d="M5 5h14a2 2 0 0 1 2 2v3a2 2 0 0 0 0 4v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3a2 2 0 0 0 0-4V7a2 2 0 0 1 2-2z"
              />
            </svg>
            Mes Tickets
          </a>
        </li>
        <li *ngIf="isClient">
          <a
            routerLink="/client/dashboard/vehicle"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              version="1.1"
              width="32"
              height="32"
              viewBox="0 0 256 256"
              xml:space="preserve"
            >
              <defs></defs>
              <g
                style="
                  stroke: none;
                  stroke-width: 0;
                  stroke-dasharray: none;
                  stroke-linecap: butt;
                  stroke-linejoin: miter;
                  stroke-miterlimit: 10;
                  fill: none;
                  fill-rule: nonzero;
                  opacity: 1;
                "
                transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"
              >
                <path
                  d="M 40.756 42.489 h -1.96 c -0.82 0 -1.484 -0.664 -1.484 -1.484 s 0.664 -1.484 1.484 -1.484 h 1.96 c 0.82 0 1.484 0.664 1.484 1.484 S 41.575 42.489 40.756 42.489 z"
                  fill="currentColor"
                />
                <path
                  d="M 89.985 44.526 c -0.919 -6.254 -12.283 -9.606 -22.7 -9.646 c -15.461 -11.31 -34.615 -11.762 -56.938 -1.342 L 3.621 34.66 C 1.523 35.009 0 36.807 0 38.934 v 10.024 c 0 1.039 0.374 2.044 1.051 2.829 l 2.335 2.708 c 0.824 0.956 2.02 1.504 3.282 1.504 h 2.184 c 0.862 4.542 4.855 7.989 9.644 7.989 c 4.79 0 8.783 -3.447 9.645 -7.989 h 36.341 c 0.862 4.542 4.855 7.989 9.645 7.989 s 8.783 -3.447 9.645 -7.989 h 1.894 c 2.389 0 4.334 -1.944 4.334 -4.334 v -6.924 L 89.985 44.526 z"
                  fill="currentColor"
                />
                <path
                  d="M 74.128 49.449 c -2.602 0 -4.718 2.116 -4.718 4.718 c 0 2.601 2.116 4.717 4.718 4.717 s 4.718 -2.116 4.718 -4.717 C 78.846 51.565 76.729 49.449 74.128 49.449 z M 74.128 55.917 c -0.966 0 -1.751 -0.785 -1.751 -1.75 c 0 -0.966 0.785 -1.751 1.751 -1.751 s 1.751 0.785 1.751 1.751 C 75.879 55.132 75.093 55.917 74.128 55.917 z"
                  fill="currentColor"
                />
                <path
                  d="M 18.497 49.449 c -2.601 0 -4.718 2.116 -4.718 4.718 c 0 2.601 2.116 4.717 4.718 4.717 s 4.718 -2.116 4.718 -4.717 C 23.215 51.565 21.098 49.449 18.497 49.449 z M 18.497 55.917 c -0.965 0 -1.751 -0.785 -1.751 -1.75 c 0 -0.966 0.785 -1.751 1.751 -1.751 c 0.965 0 1.751 0.785 1.751 1.751 C 20.248 55.132 19.462 55.917 18.497 55.917 z"
                  fill="currentColor"
                />
              </g>
            </svg>

            <span *ngIf="!isSidebarCollapsed" class="ml-3">My Vehicle</span>
          </a>
        </li>
        <!-- Statistics -->
        <li *ngIf="isAdmin">
          <a
            routerLink="/admin/dashboard/statistics"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M3 3v18h18" />
              <path d="M18 9l-5 5-4-4-5 5" />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3">Statistiques</span>
          </a>
        </li>

        <!-- Parking Management -->
        <li *ngIf="isAdmin">
          <a
            routerLink="/admin/dashboard/parkings"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M5 4h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"
              />
              <path d="M12 4v16" />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3"
              >Gestion des Parkings</span
            >
          </a>
        </li>
        <li *ngIf="isAdmin">
          <a
            routerLink="/admin/dashboard/reservation-management"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5 mr-2"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
              <line x1="16" y1="2" x2="16" y2="6" />
              <line x1="8" y1="2" x2="8" y2="6" />
              <line x1="3" y1="10" x2="21" y2="10" />
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3"
              >Gestion des Reservations</span
            >
          </a>
        </li>

        <!-- logout -->
        <li>
          <button 
            (click)="logout()"
            routerLinkActive="bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-200"
            class="flex items-center p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              version="1.1"
              width="24"
              height="24"
              viewBox="0 0 256 256"
              xml:space="preserve"
            >
              <g
                style="
                  stroke: none;
                  stroke-width: 0;
                  stroke-dasharray: none;
                  stroke-linecap: butt;
                  stroke-linejoin: miter;
                  stroke-miterlimit: 10;
                  fill: none;
                  fill-rule: nonzero;
                  opacity: 1;
                "
                transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"
              >
                <path
                  d="M 69.313 54.442 c -0.397 0 -0.798 -0.118 -1.147 -0.363 c -0.904 -0.636 -1.122 -1.883 -0.487 -2.786 l 10.118 -14.399 L 67.679 22.495 c -0.635 -0.904 -0.417 -2.151 0.487 -2.786 c 0.904 -0.637 2.151 -0.417 2.786 0.486 l 10.926 15.549 c 0.484 0.69 0.484 1.61 0 2.3 L 70.952 53.592 C 70.563 54.146 69.943 54.442 69.313 54.442 z"
                  style="
                    stroke: none;
                    stroke-width: 1;
                    stroke-dasharray: none;
                    stroke-linecap: butt;
                    stroke-linejoin: miter;
                    stroke-miterlimit: 10;
                    fill: currentColor;
                    fill-rule: nonzero;
                    opacity: 1;
                  "
                  transform=" matrix(1 0 0 1 0 0) "
                  stroke-linecap="round"
                />
                <path
                  d="M 57.693 30.092 c 1.104 0 2 -0.896 2 -2 V 2 c 0 -1.104 -0.896 -2 -2 -2 H 9.759 C 9.746 0 9.735 0.003 9.722 0.004 C 9.685 0.004 9.648 0.012 9.611 0.015 c -0.122 0.009 -0.24 0.027 -0.354 0.057 C 9.211 0.083 9.168 0.098 9.124 0.113 C 9.011 0.151 8.903 0.198 8.8 0.255 C 8.775 0.269 8.747 0.274 8.723 0.289 c -0.012 0.007 -0.02 0.018 -0.031 0.025 c -0.13 0.083 -0.252 0.177 -0.36 0.287 C 8.313 0.62 8.299 0.643 8.281 0.662 C 8.196 0.757 8.12 0.859 8.053 0.969 C 8.029 1.009 8.008 1.05 7.987 1.091 C 7.935 1.192 7.893 1.297 7.858 1.407 C 7.845 1.449 7.83 1.489 7.82 1.532 C 7.783 1.683 7.759 1.838 7.759 2 v 69.787 c 0 0.17 0.028 0.333 0.068 0.49 c 0.011 0.043 0.025 0.083 0.039 0.124 c 0.04 0.123 0.091 0.239 0.152 0.35 c 0.019 0.033 0.034 0.068 0.054 0.1 c 0.086 0.135 0.185 0.26 0.3 0.371 c 0.022 0.021 0.047 0.037 0.07 0.058 c 0.102 0.09 0.214 0.169 0.333 0.237 c 0.021 0.012 0.037 0.03 0.058 0.042 l 31.016 16.213 C 40.139 89.925 40.457 90 40.775 90 c 0.359 0 0.718 -0.097 1.036 -0.289 c 0.598 -0.362 0.964 -1.012 0.964 -1.711 V 73.787 h 14.918 c 1.104 0 2 -0.896 2 -2 V 45 c 0 -1.104 -0.896 -2 -2 -2 s -2 0.896 -2 2 v 24.787 H 42.775 V 18.213 c 0 -0.745 -0.414 -1.428 -1.074 -1.772 L 17.902 4 h 37.791 v 24.092 C 55.693 29.196 56.589 30.092 57.693 30.092 z"
                  style="
                    stroke: none;
                    stroke-width: 1;
                    stroke-dasharray: none;
                    stroke-linecap: butt;
                    stroke-linejoin: miter;
                    stroke-miterlimit: 10;
                    fill: currentColor;
                    fill-rule: nonzero;
                    opacity: 1;
                  "
                  transform=" matrix(1 0 0 1 0 0) "
                  stroke-linecap="round"
                />
                <path
                  d="M 80.241 38.894 H 47.536 c -1.104 0 -2 -0.896 -2 -2 s 0.896 -2 2 -2 h 32.705 c 1.104 0 2 0.896 2 2 S 81.346 38.894 80.241 38.894 z"
                  style="
                    stroke: none;
                    stroke-width: 1;
                    stroke-dasharray: none;
                    stroke-linecap: butt;
                    stroke-linejoin: miter;
                    stroke-miterlimit: 10;
                    fill: currentColor;
                    fill-rule: nonzero;
                    opacity: 1;
                  "
                  transform=" matrix(1 0 0 1 0 0) "
                  stroke-linecap="round"
                />
              </g>
            </svg>
            <span *ngIf="!isSidebarCollapsed" class="ml-3">déconnexion</span>
          </button>
        </li>
      </ul>
    </nav>
  </aside>
</div>

<!-- Overlay for mobile -->
<div
  *ngIf="(isHandset$ | async) && isMobileOpen"
  class="fixed inset-0 bg-black bg-opacity-50 z-30"
  (click)="closeMobileSidebar()"
></div>
